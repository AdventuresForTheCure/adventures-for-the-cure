function Member(e){var r=e("/api/members",{},{});return r.prototype.isAdmin=function(){return this.isRole("admin")},r.prototype.setAdmin=function(e){this.setRole("admin",e)},r.prototype.isInventory=function(){return this.isRole("inventory")},r.prototype.setInventory=function(e){this.setRole("inventory",e)},r.prototype.isBoard=function(){return this.isRole("board")},r.prototype.setBoard=function(e){this.setRole("board",e)},r.prototype.isRole=function(e){return this.roles&&this.roles.indexOf(e)>-1},r.prototype.setRole=function(e,r){if(r&&-1===this.roles.indexOf(e))this.roles.push(e);else{var t=this.roles.indexOf(e);this.roles.splice(t,1)}},r}function authorizationService(e,r,t,n){return{authenticateMember:function(o,i){var a=r.defer();return e.post("/login",{username:o,password:i}).then(function(e){if(e.data.success){var r=new n;angular.extend(r,e.data.user),t.currentMember=r,a.resolve(!0)}else a.resolve(!1)}),a.promise},logoutMember:function(){var n=r.defer();return e.post("/logout",{logout:!0}).then(function(){t.currentMember=void 0,n.resolve()}),n.promise},authorizeAuthorizedMemberForRoute:function(e){return t.isAuthorized(e)?!0:r.reject("not authorized")},authorizeAuthenticatedMemberForRoute:function(e){return t.isAuthenticated()&&(e.current.params.id===t.currentMember._id||t.isAuthorized("admin"))?!0:r.reject("not authorized")},createMember:function(e){var o=new n(e),i=r.defer();return o.$save().then(function(){t.currentMember=o,i.resolve()},function(e){i.reject(e.data.reason)}),i.promise}}}function campaignService(e,r){return{getCampaigns:function(){var t=e.defer();return r.get("/api/campaigns/").success(function(e){t.resolve(e)}).error(function(e){t.reject(e.reason)}),t.promise},getCampaign:function(t){var n=e.defer();return r.get("/api/campaigns/"+t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e.reason)}),n.promise}}}function identityService(e,r){var t;return e.bootstrappedMemberObject&&(t=new r,angular.extend(t,e.bootstrappedMemberObject)),{currentMember:t,isAuthenticated:function(){return!!this.currentMember},isAuthorized:function(e){return!!this.currentMember&&this.currentMember.isRole(e)},isAdmin:function(){return!!this.currentMember&&this.currentMember.isRole("admin")},isBoard:function(){return!!this.currentMember&&this.currentMember.isRole("board")},isInventory:function(){return!!this.currentMember&&this.currentMember.isRole("inventory")}}}function inventoryService(e,r){return{getInventoryItems:function(){var t=e.defer();return r.get("/api/inventoryItems/").success(function(e){t.resolve(e)}).error(function(e){t.reject(e.reason)}),t.promise},save:function(t){var n=e.defer(),o="/api/inventoryItems/";return t._id&&(o="/api/inventoryItems/"+t._id),r.post(o,t).success(function(e){n.resolve(e)}).error(function(e){console.log(e),n.reject(e.reason)}),n.promise},"delete":function(t){var n=e.defer();return r.delete("/api/inventoryItems/"+t._id).success(function(){n.resolve()}).error(function(e){n.reject(e.reason)}),n.promise}}}function memberService(e,r,t,n){function o(e){e=JSON.parse(e);for(var r=[],t=0;t<e.length;t++)r[t]=new n(e[t]);return r}var i;return{deleteMember:function(t){var n=e.defer();return r.delete("/api/members/"+t._id).success(function(){n.resolve()}).error(function(e){n.reject(e.reason)}),n.promise},getMembers:function(){var t=e.defer(),n={transformResponse:o};return r.get("/api/members/",n).success(function(e){i=e,t.resolve(i)}).error(function(e){t.reject(e.reason)}),t.promise},getMember:function(t){var n=e.defer();return r.get("/api/members/"+t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e.reason)}),n.promise},saveMember:function(r){var n=e.defer(),o="/api/members/";return r._id&&(o="/api/members/"+r._id),t.upload({url:o,data:r,file:r.img}).progress(function(e){console.log("percent: "+parseInt(100*e.loaded/e.total))}).success(function(e){console.log(e),n.resolve(e)}).error(function(e){console.log(e),n.reject(e.reason)}),n.promise},saveMemberTmpImg:function(r){var n=e.defer(),o="/api/members/tmpImg/"+r._id;return t.upload({url:o,file:r.imgTmp}).progress(function(e){console.log("percent: "+parseInt(100*e.loaded/e.total))}).success(function(e){console.log(e),n.resolve(e)}).error(function(e){console.log(e),n.reject(e.reason)}),n.promise}}}function notifierService(e){return{notify:function(r){e.success(r)},error:function(r){e.error(r)}}}function ToastrWrapper(){return toastr.options={closeButton:!0,debug:!1,positionClass:"toast-bottom-full-width",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr}function videoService(e,r){return{getVideos:function(){var t=e.defer();return r.get("/api/videos").success(function(e){t.resolve(e)}).error(function(e){t.reject(e.reason)}),t.promise},getVideo:function(t){var n=e.defer();return r.get("/api/videos/"+t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e.reason)}),n.promise}}}function volunteerEventService(e,r,t){function n(e){return e=JSON.parse(e)}var o;return{deleteVolunteerEvent:function(t){var n=e.defer();return r.delete("/api/volunteerEvents/"+t._id).success(function(){n.resolve()}).error(function(e){n.reject(e.reason)}),n.promise},getVolunteerEvents:function(){var t=e.defer(),i={transformResponse:n};return r.get("/api/volunteerEvents/",i).success(function(e){o=e,t.resolve(o)}).error(function(e){t.reject(e.reason)}),t.promise},getVolunteerEvent:function(t){var n=e.defer();return r.get("/api/volunteerEvents/"+t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e.reason)}),n.promise},saveVolunteerEvent:function(r){var n=e.defer(),o="/api/volunteerEvents/";return r._id&&(o="/api/volunteerEvents/"+r._id),t.upload({url:o,data:r,file:r.img}).progress(function(e){console.log("percent: "+parseInt(100*e.loaded/e.total))}).success(function(e){console.log(e),n.resolve(e)}).error(function(e){console.log(e),n.reject(e.reason)}),n.promise},saveVolunteerEventTmpImg:function(r){var n=e.defer(),o="/api/volunteerEvents/tmpImg/"+r._id;return t.upload({url:o,file:r.imgTmp}).progress(function(e){console.log("percent: "+parseInt(100*e.loaded/e.total))}).success(function(e){console.log(e),n.resolve(e)}).error(function(e){console.log(e),n.reject(e.reason)}),n.promise}}}function adminCtrl(e,r,t,n){e.createMember=function(){var o={username:e.username,password:e.password,firstName:e.firstName,lastName:e.lastName};n.createMember(o).then(function(){t.notify("Member account created!"),r.path("/")},function(e){t.error(e)})}}function campaignsCtrl(e,r,t,n){e.selectedCampaign=void 0,e.selectedCampaignHtml="",n.getCampaigns().then(function(o){e.campaigns=o;var i=t.hash();if(""===i)e.selectCampaign(o[o.length-1]);else{for(var a,s=0;s<o.length;s++)o[s].name===i&&(a=o[s]);a&&n.getCampaign(a.name).then(function(t){e.selectedCampaign=a,e.selectedCampaignHtml=r.trustAsHtml(t)})}}),e.selectCampaign=function(o){n.getCampaign(o.name).then(function(n){e.selectedCampaign=o,e.selectedCampaignHtml=r.trustAsHtml(n),t.hash(e.selectedCampaign.name)})}}function inventoryCtrl(e,r,t,n){e.inventoryItems={},e.getInventoryItems=function(){r.getInventoryItems().then(function(r){e.inventoryItems={};for(var t=0;t<r.length;t++){var n=r[t];angular.isUndefined(e.inventoryItems[n.category])&&(e.inventoryItems[n.category]=[]),e.inventoryItems[n.category].push(n)}},function(e){t.error(e)})},e.ableToEdit=function(){return n.currentMember&&n.currentMember.isInventory()?!0:!1},e.update=function(e){r.save(e).then(function(){t.notify("Inventory item was update")},function(e){t.error(e)})},e.delete=function(n){r.delete(n).then(function(){e.getInventoryItems(),t.notify("Inventory item was deleted")},function(e){t.error(e)})},e.getInventoryItems()}function loginCtrl(e,r,t,n){e.login=function(){n.authenticateMember(e.loginUsername,e.loginPassword).then(function(e){e?(t.notify("You have successfully signed in!"),r.path("/")):t.error("Username/Password combination incorrect")})}}function memberCreateCtrl(e,r,t,n){e.name="",e.username="",e.password="",e.confirmPassword="",e.bio="",e.roles=[],e.img=void 0,e.notifierService=t,e.createMember=function(){if(e.createMemberForm.$valid){var o={name:e.name,username:e.username,roles:e.roles,bio:e.bio,img:e.img};e.password&&e.password.length>0&&(o.password=e.password),n.saveMember(o).then(function(){t.notify("Member "+o.username+" has been created"),r.path("/member-list")},function(e){t.error(e)})}},e.onFileSelect=function(r){e.img=r[0]}}function memberEditCtrl(e,r,t,n,o,i){e.identityService=i,e.memberToEdit=void 0,e.showImgTmp=!1,o.getMember(r.current.params.id).then(function(r){e.memberToEdit=r}),e.saveMember=function(){o.saveMember(e.memberToEdit).then(function(r){e.memberToEdit=r,i.currentMember._id===e.memberToEdit._id&&angular.extend(i.currentMember,e.memberToEdit),n.notify("Member has been updated")},function(e){n.error(e)})},e.onFileSelect=function(r){e.memberToEdit.imgTmp=r[0],o.saveMemberTmpImg(e.memberToEdit).then(function(t){e.memberToEdit=t,e.memberToEdit.img=r[0],e.showImgTmp=!0})}}function memberListCtrl(e,r,t,n,o){function i(){n.getMembers().then(function(r){e.members=r})}e.identity=o,i(),e.editMember=function(e){r.path("/member-edit/"+e._id)},e.deleteMember=function(e){var r=t.open({templateUrl:"/partials/memberList/confirm-delete-member-modal",controller:confirmDeleteMemberCtrl,resolve:{member:function(){return e}}});r.result.then(function(){i()})}}function confirmDeleteMemberCtrl(e,r,t,n,o){e.member=o,e.confirm=function(){t.deleteMember(o).then(function(){n.notify("Member "+o.username+" has been deleted")},function(e){n.error(e)}),r.close()},e.cancel=function(){r.dismiss()}}function membersCtrl(e,r,t,n,o,i){e.selectedMember={},e.selectedMemberHtml="",e.editMode=!1,e.showImgTmp=!1,e.notifierService=o,n.getMembers().then(function(t){e.allMembers=t,e.membersColumn1=t.slice(0,t.length/2+1),e.membersColumn2=t.slice(t.length/2+1,t.length);for(var n=r.hash(),o=0;o<t.length;o++)t[o].name===n?e.selectMember(t[o]):""===n&&"Adam Driscoll"===t[o].name&&e.selectMember(t[o])}),e.ableToEdit=function(){return e.selectedMember&&i.isAuthenticated()&&(e.selectedMember.username===i.currentMember.username||i.currentMember.isAdmin())?!0:!1},e.selectMember=function(r){e.selectedMember=r;var n=t.location.hash.substring(1,t.location.hash.length);n!==encodeURIComponent(e.selectedMember.name)&&(t.location.hash=e.selectedMember.name)},e.saveMember=function(){e.selectedMember;n.saveMember(e.selectedMember).then(function(r){e.selectMember(r),e.editMode=!1,e.showImgTmp=!1})},e.onFileSelect=function(r){e.selectedMember.imgTmp=r[0],n.saveMemberTmpImg(e.selectedMember).then(function(t){e.selectMember(t),e.selectedMember.img=r[0],e.showImgTmp=!0})},e.enableEditMode=function(){e.editMode=!0},e.cancel=function(){e.editMode=!1,e.showImgTmp=!1}}function navbarLoginCtrl(e,r,t,n,o){e.identityService=t,e.signout=function(){o.logoutMember().then(function(){e.username="",e.password="",n.notify("You have successfully signed out!"),r.path("/")})},e.isActive=function(e){return e===r.path()}}function resultsCtrl(e,r,t){e.selectedVideoHtml="",t.getVideos().then(function(r){e.videos=r;for(var t=0;t<r.length;t++)"2014--04-06 AFC Sugar Hill XC"===r[t].name&&e.selectVideo(r[t])}),e.selectVideo=function(n){t.getVideo(n.name).then(function(t){e.selectedVideoHtml=r.trustAsHtml(t)})}}function volunteerEventCreateCtrl(e,r,t,n){e.name="",e.date="",e.isAfcEvent=!0,e.img=void 0,e.notifierService=t,e.createVolunteerEvent=function(){if(e.createVolunteerEventForm.$valid){var o={name:e.name,date:e.date,isAfcEvent:e.isAfcEvent,img:e.img};n.saveVolunteerEvent(o).then(function(){t.notify("VolunteerEvent "+o.username+" has been created"),r.path("/volunteer-event-list")},function(e){t.error(e)})}},e.onFileSelect=function(r){e.img=r[0]}}angular.module("app",["ngResource","ngRoute","ui.bootstrap","angularFileUpload"]),angular.module("app").config(["$routeProvider","$locationProvider",function(e,r){var t={admin:{auth:function(e){return e.authorizeAuthorizedMemberForRoute("admin")}},board:{auth:function(e){return e.authorizeAuthorizedMemberForRoute("board")}},inventory:{auth:function(e){return e.authorizeAuthorizedMemberForRoute("inventory")}},member:{auth:function(e,r){return r.authorizeAuthenticatedMemberForRoute(e)}}};r.html5Mode(!0),e.when("/",{redirectTo:"/home"}).when("/home",{templateUrl:"/partials/home/home"}).when("/donate",{templateUrl:"/partials/donate/donate"}).when("/events",{templateUrl:"/partials/events/events"}).when("/rides",{templateUrl:"/partials/rides/rides"}).when("/members",{templateUrl:"/partials/members/members"}).when("/results",{templateUrl:"/partials/results/results"}).when("/campaigns",{templateUrl:"/partials/campaigns/campaigns"}).when("/inventory",{templateUrl:"/partials/inventory/inventory"}).when("/contact",{templateUrl:"/partials/contact/contact"}).when("/join",{templateUrl:"/partials/join/join"}).when("/login",{templateUrl:"/partials/login/login",controller:"loginCtrl"}).when("/member-edit/:id",{templateUrl:"/partials/memberEdit/member-edit",resolve:t.member}).when("/member-list",{templateUrl:"/partials/memberList/member-list",resolve:t.admin}).when("/member-create",{templateUrl:"/partials/memberCreate/member-create",resolve:t.admin}).when("/volunteer-event-create",{templateUrl:"/partials/volunteerEventCreate/volunteer-event-create",resolve:t.board}).otherwise({templateUrl:"/partials/invalidPage/invalidPage"})}]),angular.module("app").run(["$rootScope","$location","notifierService",function(e,r,t){e.$on("$routeChangeError",function(e,r,n,o){"not authorized"===o&&t.error("You are not authorized to view this page.")})}]),angular.module("app").factory("Member",["$resource",Member]),angular.module("app").factory("authorizationService",["$http","$q","identityService","Member",authorizationService]),angular.module("app").factory("campaignService",["$q","$http",campaignService]),angular.module("app").factory("identityService",["$window","Member",identityService]),angular.module("app").factory("inventoryService",["$q","$http",inventoryService]),angular.module("app").factory("memberService",["$q","$http","$upload","Member",memberService]),angular.module("app").factory("notifierService",["toastrService",notifierService]),angular.module("app").service("toastrService",ToastrWrapper),angular.module("app").factory("videoService",["$q","$http",videoService]),angular.module("app").factory("volunteerEventService",["$q","$http","$upload",volunteerEventService]),angular.module("app").controller("adminCtrl",adminCtrl),adminCtrl.$inject=["$scope","$location","notifierService","authorizationService"],angular.module("app").controller("campaignsCtrl",campaignsCtrl),campaignsCtrl.$inject=["$scope","$sce","$location","campaignService"],angular.module("app").controller("inventoryCtrl",inventoryCtrl),inventoryCtrl.$inject=["$scope","inventoryService","notifierService","identityService"],angular.module("app").controller("loginCtrl",loginCtrl),loginCtrl.$inject=["$scope","$location","notifierService","authorizationService"],angular.module("app").controller("memberCreateCtrl",memberCreateCtrl),memberCreateCtrl.$inject=["$scope","$location","notifierService","memberService"],angular.module("app").controller("memberEditCtrl",memberEditCtrl),memberEditCtrl.$inject=["$scope","$route","$location","notifierService","memberService","identityService"],angular.module("app").controller("memberListCtrl",memberListCtrl),memberListCtrl.$inject=["$scope","$location","$modal","memberService","identityService"],confirmDeleteMemberCtrl.$inject=["$scope","$modalInstance","memberService","notifierService","member"],angular.module("app").controller("membersCtrl",membersCtrl),membersCtrl.$inject=["$scope","$location","$window","memberService","notifierService","identityService"],angular.module("app").controller("navbarLoginCtrl",navbarLoginCtrl),navbarLoginCtrl.$inject=["$scope","$location","identityService","notifierService","authorizationService"],angular.module("app").controller("resultsCtrl",resultsCtrl),resultsCtrl.$inject=["$scope","$sce","videoService"],angular.module("app").controller("volunteerEventCreateCtrl",volunteerEventCreateCtrl),volunteerEventCreateCtrl.$inject=["$scope","$location","notifierService","volunteerEventService"];