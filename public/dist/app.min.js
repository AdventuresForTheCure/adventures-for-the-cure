function Campaign(e){var r=e("/api/campaigns",{},{});return r}function Inventory(e){var r=e("/api/inventoryItems",{},{});return r}function Member(e){var r=e("/api/members",{},{query:{method:"GET",isArray:!0,cache:!0}});return r}function User(e){var r=e("/api/users/:id",{id:"@_id"},{});return r.prototype.isAdmin=function(){return this.roles&&this.roles.indexOf("admin")>-1},r.prototype.isBoard=function(){return this.roles&&this.roles.indexOf("board")>-1},r}function Video(e){var r=e("/api/video",{},{query:{method:"GET",isArray:!0,cache:!0}});return r}function authorizationService(e,r,t,n){return{authenticateUser:function(o,i){var a=r.defer();return e.post("/login",{username:o,password:i}).then(function(e){if(e.data.success){var r=new n;angular.extend(r,e.data.user),t.currentUser=r,a.resolve(!0)}else a.resolve(!1)}),a.promise},logoutUser:function(){var n=r.defer();return e.post("/logout",{logout:!0}).then(function(){t.currentUser=void 0,n.resolve()}),n.promise},authorizeAuthorizedUserForRoute:function(e){return t.isAuthorized(e)?!0:r.reject("not authorized")},authorizeAuthenticatedUserForRoute:function(){return t.isAuthenticated()?!0:r.reject("not authorized")},createUser:function(e){var o=new n(e),i=r.defer();return o.$save().then(function(){t.currentUser=o,i.resolve()},function(e){i.reject(e.data.reason)}),i.promise}}}function campaignService(e,r,t){return{getCampaigns:function(){return t.query().$promise},getCampaign:function(t){var n=e.defer();return r.get("/api/campaigns/"+t).then(function(e){n.resolve(e.data)}),n.promise}}}function identityService(e,r){var t;return e.bootstrappedUserObject&&(t=new r,angular.extend(t,e.bootstrappedUserObject)),{currentUser:t,isAuthenticated:function(){return!!this.currentUser},isAuthorized:function(e){return!!this.currentUser&&this.currentUser.roles.indexOf(e)>-1},isAdmin:function(){return!!this.currentUser&&this.currentUser.roles.indexOf("admin")>-1},isBoard:function(){return!!this.currentUser&&this.currentUser.roles.indexOf("board")>-1}}}function inventoryService(e){return{getInventoryItems:function(){return e.query().$promise}}}function memberService(e,r,t){return{getMembers:function(){return t.query().$promise},getMember:function(t){var n=e.defer();return r.get("/api/members/"+t).then(function(e){n.resolve(e.data)}),n.promise}}}function notifierService(e){return{notify:function(r){e.success(r)},error:function(r){e.error(r)}}}function ToastrWrapper(){return toastr.options={closeButton:!0,debug:!1,positionClass:"toast-bottom-full-width",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr}function videoService(e,r,t){return{getVideos:function(){return t.query().$promise},getVideo:function(t){var n=e.defer();return r.get("/api/videos/"+t).then(function(e){n.resolve(e.data)}),n.promise}}}function adminCtrl(e,r,t,n){e.createUser=function(){var o={username:e.username,password:e.password,firstName:e.firstName,lastName:e.lastName};n.createUser(o).then(function(){t.notify("User account created!"),r.path("/")},function(e){t.error(e)})}}function campaignsCtrl(e,r,t){e.selectedCampaignHtml="",t.getCampaigns().then(function(r){e.campaigns=r;for(var t=0;t<r.length;t++)"2014-01-01 Miles To The Moon"===r[t].name&&e.selectCampaign(r[t])}),e.selectCampaign=function(n){t.getCampaign(n.name).then(function(t){e.selectedCampaignHtml=r.trustAsHtml(t)})}}function inventoryCtrl(e,r){e.inventoryItems={},r.getInventoryItems().then(function(r){for(var t=0;t<r.length;t++){var n=r[t];angular.isUndefined(e.inventoryItems[n.category])&&(e.inventoryItems[n.category]=[]),e.inventoryItems[n.category].push(n)}})}function loginCtrl(e,r,t,n){e.login=function(){n.authenticateUser(e.loginUsername,e.loginPassword).then(function(e){e?(t.notify("You have successfully signed in!"),r.path("/")):t.error("Username/Password combination incorrect")})}}function membersCtrl(e,r,t,n){e.selectedMember=void 0,e.selectedMemberHtml="";var o=t.hash()?t.hash():"Adam Driscoll";n.getMembers().then(function(r){if(angular.isUndefined(e.allMembers)){e.allMembers=r,e.membersColumn1=r.slice(0,r.length/2),e.membersColumn2=r.slice(r.length/2,r.length);for(var t=0;t<r.length;t++)r[t].name===o&&e.selectMember(r[t])}}),e.selectMember=function(o){e.selectedMember=o,n.getMember(o.name).then(function(n){e.selectedMemberHtml=r.trustAsHtml(n),t.hash(o.name)})}}function navbarLoginCtrl(e,r,t,n,o){e.identityService=t,e.signout=function(){o.logoutUser().then(function(){e.username="",e.password="",n.notify("You have successfully signed out!"),r.path("/")})},e.isActive=function(e){return e===r.path()}}function resultsCtrl(e,r,t){e.selectedVideoHtml="",t.getVideos().then(function(r){e.videos=r;for(var t=0;t<r.length;t++)"2014--04-06 AFC Sugar Hill XC"===r[t].name&&e.selectVideo(r[t])}),e.selectVideo=function(n){t.getVideo(n.name).then(function(t){e.selectedVideoHtml=r.trustAsHtml(t)})}}angular.module("app",["ngResource","ngRoute","ui.bootstrap"]),angular.module("app").config(["$routeProvider","$locationProvider",function(e,r){var t={admin:{auth:function(e){return e.authorizeAuthorizedUserForRoute("admin")}},board:{auth:function(e){return e.authorizeAuthorizedUserForRoute("board")}},user:{auth:function(e){return e.authorizeAuthenticatedUserForRoute()}}};r.html5Mode(!0),e.when("/",{redirectTo:"/home"}).when("/home",{templateUrl:"/partials/home/home"}).when("/donate",{templateUrl:"/partials/donate/donate"}).when("/events",{templateUrl:"/partials/events/events"}).when("/rides",{templateUrl:"/partials/rides/rides"}).when("/members",{templateUrl:"/partials/members/members"}).when("/results",{templateUrl:"/partials/results/results"}).when("/inventory",{templateUrl:"/partials/inventory/inventory"}).when("/contact",{templateUrl:"/partials/contact/contact"}).when("/login",{templateUrl:"/partials/login/login",controller:"loginCtrl"}).when("/admin",{templateUrl:"/partials/admin/admin",controller:"adminCtrl",resolve:t.admin}).otherwise({templateUrl:"/partials/invalidPage/invalidPage"})}]),angular.module("app").run(["$rootScope","$location","notifierService",function(e,r,t){e.$on("$routeChangeError",function(e,n,o,i){"not authorized"===i&&(r.path("/views/login/login"),t.error("You do not have access to that page, please login first"))})}]),angular.module("app").factory("Campaign",["$resource",Campaign]),angular.module("app").factory("Inventory",["$resource",Inventory]),angular.module("app").factory("Member",["$resource",Member]),angular.module("app").factory("User",["$resource",User]),angular.module("app").factory("Video",["$resource",Video]),angular.module("app").factory("authorizationService",["$http","$q","identityService","User",authorizationService]),angular.module("app").factory("campaignService",["$q","$http","Campaign",campaignService]),angular.module("app").factory("identityService",["$window","User",identityService]),angular.module("app").factory("inventoryService",["Inventory",inventoryService]),angular.module("app").factory("memberService",["$q","$http","Member",memberService]),angular.module("app").factory("notifierService",["toastrService",notifierService]),angular.module("app").service("toastrService",ToastrWrapper),angular.module("app").factory("userService",["$q","User",function(e,r){return{getUsers:function(){return r.query()},getUser:function(e){return r.get({id:e})},deleteUser:function(r){var t=e.defer();return r.$delete().then(function(){t.resolve()},function(e){t.reject(e.data.reason)}),t.promise},saveUserDataAsNewUser:function(t){var n=new r(t),o=e.defer();return n.$save().then(function(e){o.resolve(e)},function(e){o.reject(e.data.reason)}),o.promise},saveUser:function(r){var t=e.defer();return r.$save().then(function(e){t.resolve(e)},function(e){t.reject(e.data.reason)}),t.promise}}}]),angular.module("app").factory("videoService",["$q","$http","Video",videoService]),angular.module("app").controller("adminCtrl",adminCtrl),adminCtrl.$inject=["$scope","$location","notifierService","authorizationService"],angular.module("app").controller("campaignsCtrl",campaignsCtrl),campaignsCtrl.$inject=["$scope","$sce","campaignService"],angular.module("app").controller("inventoryCtrl",inventoryCtrl),inventoryCtrl.$inject=["$scope","inventoryService"],angular.module("app").controller("loginCtrl",loginCtrl),loginCtrl.$inject=["$scope","$location","notifierService","authorizationService"],angular.module("app").controller("membersCtrl",membersCtrl),membersCtrl.$inject=["$scope","$sce","$location","memberService"],angular.module("app").controller("navbarLoginCtrl",navbarLoginCtrl),navbarLoginCtrl.$inject=["$scope","$location","identityService","notifierService","authorizationService"],angular.module("app").controller("resultsCtrl",resultsCtrl),resultsCtrl.$inject=["$scope","$sce","videoService"];